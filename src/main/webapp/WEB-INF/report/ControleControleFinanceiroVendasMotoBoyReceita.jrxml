<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="ControleControleFinanceiroVendasMotoBoyReceita" pageWidth="595" pageHeight="842" columnWidth="595" leftMargin="0" rightMargin="0" topMargin="0" bottomMargin="0" uuid="fb9211e9-92dc-4117-b622-3ebef0de4c13">
	<property name="ireport.zoom" value="1.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<property name="ireport.scriptlethandling" value="0"/>
	<property name="ireport.encoding" value="UTF-8"/>
	<import value="net.sf.jasperreports.engine.*"/>
	<import value="java.util.*"/>
	<import value="net.sf.jasperreports.engine.data.*"/>
	<parameter name="pLogo" class="java.lang.String" isForPrompting="false"/>
	<parameter name="SUBREPORT_DIR" class="java.lang.String" isForPrompting="false"/>
	<parameter name="pListaContagem" class="java.util.List" isForPrompting="false"/>
	<parameter name="pCdEntregador" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[new Integer("10")]]></defaultValueExpression>
	</parameter>
	<parameter name="pDataInicio" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA["01/11/2020"]]></defaultValueExpression>
	</parameter>
	<parameter name="pDataFinal" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA["30/11/2020"]]></defaultValueExpression>
	</parameter>
	<parameter name="pCdEmpresa" class="java.lang.Integer" isForPrompting="false">
		<defaultValueExpression><![CDATA[new Integer("1")]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[select
	SUM(dias) dias ,SUM( diaria) diaria
    , cd_entregador, SUM((diaria*dias) )vl_mes,  NM_ENTREGADOR
    , SUM(receita) receita ,
    SUM(receita) - SUM((diaria*dias))  total
 from (
SELECT
	COUNT(DISTINCT (STR_TO_DATE(DATE_FORMAT(p.dt_entrega, '%d-%m-%Y'),     '%d-%m-%Y') )) dias
	, MAX(e.vl_diaria) diaria , p.cd_entregador
	, concat(e.NM_ENTREGADOR, ' (', case when e.sn_ativo = 'S' then 'ATIVO' else 'INATIVO' end, ')' )NM_ENTREGADOR
	, 	IFNULL( SUM(   p.vl_pedido  - (  (p.vl_pedido  *taxa ) /100)       )  ,    SUM(  p.vl_pedido   )  )  receita

FROM
pedido p
INNER JOIN entregador e  on p.cd_entregador = e.cd_entregador
INNER JOIN forma_pagamento fp ON fp.CD_FORMA_PAGAMENTO = p.CD_FORMA_PAGAMENTO
INNER JOIN tip_prato tp ON tp.CD_TIP_PRATO = p.CD_TIP_PRATO
where  e.CD_ENTREGADOR = case when  $P!{pCdEntregador} = 0 then  e.CD_ENTREGADOR else  $P!{pCdEntregador} end
and p.cd_empresa  = $P!{pCdEmpresa}
and   STR_TO_DATE(DATE_FORMAT(p.dt_entrega, '%d-%m-%Y'),     '%d-%m-%Y')
  between STR_TO_DATE( '$P!{pDataInicio}', '%d/%m/%Y' )
            and  STR_TO_DATE('$P!{pDataFinal}', '%d/%m/%Y' )
and tp.sn_contagem = 'S'
group by    p.cd_empresa, p.cd_entregador, concat(e.NM_ENTREGADOR, ' (', case when e.sn_ativo = 'S' then 'ATIVO' else 'INATIVO' end, ')' ),fp.CD_FORMA_PAGAMENTO
) a GROUP BY   cd_entregador ,  NM_ENTREGADOR]]>
	</queryString>
	<field name="dias" class="java.lang.Long"/>
	<field name="diaria" class="java.lang.Float"/>
	<field name="cd_entregador" class="java.lang.Integer"/>
	<field name="vl_mes" class="java.lang.Double"/>
	<field name="NM_ENTREGADOR" class="java.lang.String"/>
	<field name="receita" class="java.lang.Double"/>
	<field name="total" class="java.lang.Double"/>
	<group name="Entregador">
		<groupExpression><![CDATA[$F{cd_entregador}]]></groupExpression>
		<groupHeader>
			<band splitType="Stretch">
				<printWhenExpression><![CDATA[new Boolean ($P{pCdEntregador}.equals( new Integer("0")))]]></printWhenExpression>
			</band>
		</groupHeader>
		<groupFooter>
			<band splitType="Stretch"/>
		</groupFooter>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band splitType="Stretch"/>
	</title>
	<pageHeader>
		<band splitType="Stretch"/>
	</pageHeader>
	<columnHeader>
		<band splitType="Stretch"/>
	</columnHeader>
	<detail>
		<band height="11" splitType="Prevent">
			<printWhenExpression><![CDATA[new Boolean ($P{pCdEntregador}.equals( new Integer("0")))]]></printWhenExpression>
			<textField pattern="R$ #,##0.00" isBlankWhenNull="true">
				<reportElement key="textField-5" positionType="Float" x="154" y="-1" width="110" height="12" uuid="b29341e7-2cf4-49e2-9c1e-d0a78705a749"/>
				<box leftPadding="2" rightPadding="2">
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Bottom">
					<font size="9" isBold="false" pdfFontName="Helvetica"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{diaria}]]></textFieldExpression>
			</textField>
			<textField pattern="" isBlankWhenNull="true">
				<reportElement key="textField-6" positionType="Float" x="265" y="-1" width="47" height="12" uuid="5d4d243d-3027-49fc-a9fa-a698e6d46195"/>
				<box leftPadding="2" rightPadding="2">
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Bottom">
					<font size="9"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{dias}]]></textFieldExpression>
			</textField>
			<textField pattern="R$ #,##0.00" isBlankWhenNull="true">
				<reportElement key="textField-7" positionType="Float" x="314" y="-1" width="67" height="12" uuid="08bcf493-4efd-412f-9fe5-aac9de893211"/>
				<box leftPadding="2" rightPadding="2">
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Bottom">
					<font size="9"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{vl_mes}]]></textFieldExpression>
			</textField>
			<textField pattern="R$ #,##0.00" isBlankWhenNull="true">
				<reportElement key="textField-8" positionType="Float" x="444" y="-1" width="82" height="12" uuid="ee926153-9dbc-4202-8c67-3e5acf561833"/>
				<box leftPadding="2" rightPadding="2">
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Bottom">
					<font size="9"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{total}]]></textFieldExpression>
			</textField>
			<textField pattern="R$ #,##0.00" isBlankWhenNull="true">
				<reportElement key="textField-14" positionType="Float" x="0" y="-1" width="154" height="12" uuid="20439e7b-add9-4308-89f9-012fb9e8a31e"/>
				<box leftPadding="2" rightPadding="2">
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Bottom">
					<font size="9" isBold="false" pdfFontName="Helvetica"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{NM_ENTREGADOR}]]></textFieldExpression>
			</textField>
			<textField pattern="R$ #,##0.00" isBlankWhenNull="true">
				<reportElement key="textField-16" positionType="Float" x="381" y="-1" width="67" height="12" uuid="c2e86c82-31c6-482c-9583-78f1d3f0b986"/>
				<box leftPadding="2" rightPadding="2">
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Bottom">
					<font size="9"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{receita}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<columnFooter>
		<band splitType="Stretch"/>
	</columnFooter>
	<pageFooter>
		<band splitType="Stretch"/>
	</pageFooter>
	<summary>
		<band height="25" splitType="Stretch">
			<printWhenExpression><![CDATA[new Boolean (!$P{pCdEntregador}.equals( new Integer("0")))]]></printWhenExpression>
			<staticText>
				<reportElement key="staticText-5" positionType="Float" x="1" y="0" width="140" height="13" uuid="52842e8d-6357-40f6-9575-ccb2aa4ee2b1"/>
				<box leftPadding="2" rightPadding="2">
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Bottom">
					<font isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<text><![CDATA[Valor da DiÃ¡ria]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText-6" positionType="Float" x="427" y="0" width="107" height="13" uuid="c3ab9103-2527-429e-adfb-d7c4a142bcd6"/>
				<box leftPadding="2" rightPadding="2">
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Bottom">
					<font isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<text><![CDATA[Total]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText-7" positionType="Float" x="141" y="0" width="79" height="13" uuid="bfdef8f7-5472-4df8-80b0-db8be2aca2b3"/>
				<box leftPadding="2" rightPadding="2">
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Bottom">
					<font isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<text><![CDATA[Dias Trabalhados]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText-8" positionType="Float" x="220" y="0" width="100" height="13" uuid="aef151d3-4736-42aa-bdb4-47a044be8525"/>
				<box leftPadding="2" rightPadding="2">
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Bottom">
					<font isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<text><![CDATA[Valor Total]]></text>
			</staticText>
			<textField pattern="R$ #,##0.00" isBlankWhenNull="true">
				<reportElement key="textField-10" positionType="Float" x="1" y="13" width="140" height="12" uuid="e16f6f5f-1b82-4d62-b34c-beea1565b7d5"/>
				<box leftPadding="2" rightPadding="2">
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Bottom">
					<font size="9" isBold="false" pdfFontName="Helvetica"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{diaria}]]></textFieldExpression>
			</textField>
			<textField pattern="" isBlankWhenNull="true">
				<reportElement key="textField-11" positionType="Float" x="141" y="13" width="79" height="12" uuid="85ad9d52-3321-42de-8ccb-e3fa67c1c956"/>
				<box leftPadding="2" rightPadding="2">
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Bottom">
					<font size="9"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{dias}]]></textFieldExpression>
			</textField>
			<textField pattern="R$ #,##0.00" isBlankWhenNull="true">
				<reportElement key="textField-12" positionType="Float" x="220" y="13" width="100" height="12" uuid="1257f3f8-b54d-4315-9230-7a3c30c02727"/>
				<box leftPadding="2" rightPadding="2">
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Bottom">
					<font size="9"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{vl_mes}]]></textFieldExpression>
			</textField>
			<textField pattern="R$ #,##0.00" isBlankWhenNull="true">
				<reportElement key="textField-13" positionType="Float" x="427" y="13" width="107" height="12" uuid="2ffd4077-ec74-4da4-b893-46003abf29ee"/>
				<box leftPadding="2" rightPadding="2">
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Bottom">
					<font size="9"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{total}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement key="staticText-9" positionType="Float" x="320" y="0" width="107" height="13" uuid="a71acccf-8f18-4d02-8de1-6db00a33ba1e"/>
				<box leftPadding="2" rightPadding="2">
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Bottom">
					<font isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<text><![CDATA[Receita]]></text>
			</staticText>
			<textField pattern="R$ #,##0.00" isBlankWhenNull="true">
				<reportElement key="textField-15" positionType="Float" x="320" y="13" width="107" height="12" uuid="2e826c6c-6361-4295-aeb9-811ae202ef6e"/>
				<box leftPadding="2" rightPadding="2">
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Bottom">
					<font size="9"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{receita}]]></textFieldExpression>
			</textField>
		</band>
	</summary>
</jasperReport>
